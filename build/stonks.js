"use strict";(()=>{function S(u){let a={};return["utm_campaign","utm_source","utm_medium","utm_term","utm_content"].forEach(p=>{let g=u.get(p);g&&(a[p]=g)}),a}function m(u){if(!u)return;let a=u.split(";"),p={};for(let g of a){let f=g.split("=").map(b=>b.trim());f.length!==2||f[0]===""||f[1]===""||(p[f[0]]=f[1])}return Object.keys(p).length===0?void 0:p}(()=>{if(!document)return;let u=null;window.stonks={event:b,view:k};let a=document.currentScript,p=a?.getAttribute("data-hash-routing")!==null,g={isLocalhost:/^localhost$|^127(\.[0-9]+){0,2}\.[0-9]+$|^\[::1?\]$/.test(location.hostname)||location.protocol==="file:",isHeadlessBrowser:!!(window._phantom||window.__nightmare||window.navigator.webdriver||window.Cypress)};async function f(t){let r=a?.getAttribute("data-url")||"https://collector.onedollarstats.com/events",n=new URL(location.href),e=a.getAttribute("data-debug"),o=!1;if(e)try{let d=new URL(`https://${e}${n.pathname}`);n.hostname!==d.hostname&&(o=!0,n=d)}catch{return}n.search="","path"in t&&t.path&&(n.pathname=t.path);let s=n.href.replace(/\/$/,""),i=t.referrer??void 0;if(!i){let d=document.referrer&&document.referrer!=="null"?document.referrer:void 0;if(d){let P=new URL(d);P.hostname!==n.hostname&&(i=P.href)}}let c={u:s,e:[{t:t.type,h:p,r:i,p:t.props}]};o&&(c.debug=o),t.utm&&Object.keys(t.utm).length>0&&(c.qs=t.utm);let l=JSON.stringify(c),v=btoa(l),h=new Image(1,1);h.onerror=()=>{navigator.sendBeacon?.(r,l)||fetch(r,{method:"POST",body:l,headers:{"Content-Type":"application/json"},keepalive:!0}).catch(d=>console.error("[onedollarstats] fetch() failed:",d.message))},h.src=`${r}?data=${v}`}async function b(t,r,n){if(y())return;let e={};typeof r=="string"?(e.path=r,n&&(e.props=n)):typeof r=="object"&&(e.props=r);let o=e?.path||void 0;if(!o){let s=document.body?.getAttribute("data-s:path")||document.querySelector('meta[name="stonks-path"]')?.getAttribute("content");s&&(o=s)}f({type:t,props:e?.props,path:o})}function R(t){if(t.type==="auxclick"&&t.button!==1)return;let r=t.target;if(!r)return;let n=!!r.closest("a, button"),e=r,o=0;for(;e;){let s=e.getAttribute("data-s:event")??e.getAttribute("data-s-event");if(s){let i=e.getAttribute("data-s:event-props")??e.getAttribute("data-s-event-props"),c=i?m(i):void 0,l=e.getAttribute("data-s:event-path")||e.getAttribute("data-s-event-path")||void 0;b(s,l,c);return}if(e=e.parentElement,o++,!n&&o>=3)break}}async function k(t,r){let n={};typeof t=="string"?(n.path=t,r&&(n.props=r)):typeof t=="object"&&(n.props=t),A({path:n?.path,props:n?.props},!1)}async function A(t,r=!0){if(r&&y())return;let n=new URLSearchParams(location.search),e=S(n),o=t?.path||void 0;if(!o){let i=document.body?.getAttribute("data-s:path")||document.querySelector('meta[name="stonks-path"]')?.getAttribute("content");i&&(o=i)}let s=t.props||void 0;if(!s){let i=a?.getAttribute("data-props"),c=i?m(i)||{}:{},l=document.querySelectorAll("[data-s\\:view-props]");for(let v of Array.from(l)){let h=v.getAttribute("data-s:view-props");if(!h)continue;let d=m(h);Object.assign(c,d)}s=c}f({type:"PageView",props:Object.keys(s).length>0?s:void 0,path:o,utm:e})}async function w(){let t=document.querySelector('meta[name="stonks-collect"]')?.getAttribute("content"),r=document.body?.getAttribute("data-s:collect");if(t==="false"||r==="false"){u=null;return}if(!(a?.getAttribute("data-autocollect")!=="false")&&t!=="true"&&r!=="true"){u=null;return}if(!p&&u===location.pathname){console.warn("Ignoring event PageView - pathname has not changed");return}if(y())return;u=location.pathname;let e=a?.getAttribute("data-props"),o=e?m(e)||{}:{},s=document.querySelectorAll("[data-s\\:view-props]");for(let i of Array.from(s)){let c=i.getAttribute("data-s:view-props");if(!c)continue;let l=m(c);Object.assign(o,l)}A({props:Object.keys(o).length>0?o:void 0},!1)}function y(){return!!(g.isLocalhost&&!a?.getAttribute("data-debug")||g.isHeadlessBrowser)}if(window.history.pushState){let t=window.history.pushState;window.history.pushState=function(r,n,e){t.apply(this,[r,n,e]),window.requestAnimationFrame(()=>{w()})},window.addEventListener("popstate",()=>{window.requestAnimationFrame(()=>{w()})})}document.visibilityState!=="visible"?document.addEventListener("visibilitychange",()=>{!u&&document.visibilityState==="visible"&&w()}):w(),document.addEventListener("click",R)})();})();
