"use strict";(()=>{function E(l){let c={};return["utm_campaign","utm_source","utm_medium","utm_term","utm_content"].forEach(u=>{let d=l.get(u);d&&(c[u]=d)}),c}function h(l){if(!l)return;let c=l.split(";"),u={};for(let d of c){let f=d.split("=").map(b=>b.trim());f.length!==2||f[0]===""||f[1]===""||(u[f[0]]=f[1])}return Object.keys(u).length===0?void 0:u}(()=>{if(!document)return;let l=null;window.stonks={event:P,view:$};let c=document.currentScript,u=c?.getAttribute("data-hash-routing")!==null,d={isLocalhost:/^localhost$|^127(\.[0-9]+){0,2}\.[0-9]+$|^\[::1?\]$/.test(location.hostname)||location.protocol==="file:",isHeadlessBrowser:!!(window._phantom||window.__nightmare||window.navigator.webdriver||window.Cypress)},f=c?.getAttribute("data-debug");d.isLocalhost&&f&&console.log(`[onedollarstats]
Script successfully connected! Tracking your localhost as ${f}`);async function b(t,o){navigator.sendBeacon?.(t,o)||fetch(t,{method:"POST",body:o,headers:{"Content-Type":"application/json"},keepalive:!0}).catch(e=>console.error("[onedollarstats] fetch() failed:",e.message))}async function A(t){let o=c?.getAttribute("data-url")||"https://collector.onedollarstats.com/events",e=new URL(location.href),n=c.getAttribute("data-debug"),s=!1;if(n)try{let a=new URL(`https://${n}${e.pathname}`);e.hostname!==a.hostname&&(s=!0,e=a)}catch{return}e.search="","path"in t&&t.path&&(e.pathname=t.path);let i=e.href.replace(/\/$/,""),r=t.referrer??void 0;if(!r){let a=document.referrer&&document.referrer!=="null"?document.referrer:void 0;if(a){let k=new URL(a);k.hostname!==e.hostname&&(r=k.href)}}let p={u:i,e:[{t:t.type,h:u,r,p:t.props}]};if(t.utm&&Object.keys(t.utm).length>0&&(p.qs=t.utm),s){p.debug=s;let a=`[onedollarstats]
Event name: ${t.type}
Event collected from: ${i}`;t.props&&Object.keys(t.props).length>0&&(a+=`
Props: ${JSON.stringify(t.props,null,2)}`),r&&(a+=`
Referrer: ${r}`),u&&(a+=`
HashRouting: ${u}`),t.utm&&Object.keys(t.utm).length>0&&(a+=`
UTM: ${t.utm}`),console.log(a)}let g=JSON.stringify(p),m=btoa(g);if(m.length<=1500){let a=new Image(1,1);a.onerror=()=>b(o,g),a.src=`${o}?data=${m}`}else await b(o,g)}async function P(t,o,e){if(y())return;let n={};typeof o=="string"?(n.path=o,e&&(n.props=e)):typeof o=="object"&&(n.props=o);let s=n?.path||void 0;if(!s){let i=document.body?.getAttribute("data-s-path")||document.body?.getAttribute("data-s:path");i&&(s=i)}A({type:t,props:n?.props,path:s})}function L(t){if(t.type==="auxclick"&&t.button!==1)return;let o=t.target;if(!o)return;let e=!!o.closest("a, button"),n=o,s=0;for(;n;){let i=n.getAttribute("data-s-event")||n.getAttribute("data-s:event");if(i){let r=n.getAttribute("data-s-event-props")||n.getAttribute("data-s:event-props"),p=r?h(r):void 0,g=n.getAttribute("data-s-event-path")||n.getAttribute("data-s:event-path")||void 0;P(i,g??p,p);return}if(n=n.parentElement,s++,!e&&s>=3)break}}async function $(t,o){let e={};typeof t=="string"?(e.path=t,o&&(e.props=o)):typeof t=="object"&&(e.props=t),S({path:e?.path,props:e?.props},!1)}async function S(t,o=!0){if(o&&y())return;let e=new URLSearchParams(location.search),n=E(e),s=t?.path||void 0;if(!s){let r=document.body?.getAttribute("data-s-path")||document.body?.getAttribute("data-s:path");r&&(s=r)}let i=t.props||void 0;if(!i){let r=c?.getAttribute("data-props"),p=r?h(r)||{}:{},g=document.querySelectorAll("[data-s\\:view-props], [data-s-view-props]");for(let m of Array.from(g)){let v=m.getAttribute("data-s-view-props")||m.getAttribute("data-s:view-props");if(!v)continue;let R=h(v);Object.assign(p,R)}i=p}A({type:"PageView",props:Object.keys(i).length>0?i:void 0,path:s,utm:n})}async function w(){let t=document.body?.getAttribute("data-s-collect")||document.body?.getAttribute("data-s:collect");if(t==="false"){l=null;return}if(!(c?.getAttribute("data-autocollect")!=="false")&&t!=="true"){l=null;return}if(!u&&l===location.pathname){console.warn("Ignoring event PageView - pathname has not changed");return}if(y())return;l=location.pathname;let e=c?.getAttribute("data-props"),n=e?h(e)||{}:{},s=document.querySelectorAll("[data-s\\:view-props], [data-s-view-props]");for(let i of Array.from(s)){let r=i.getAttribute("data-s-view-props")||i.getAttribute("data-s:view-props");if(!r)continue;let p=h(r);Object.assign(n,p)}S({props:Object.keys(n).length>0?n:void 0},!1)}function y(){return!!(d.isLocalhost&&!c?.getAttribute("data-debug")||d.isHeadlessBrowser)}if(window.history.pushState){let t=window.history.pushState;window.history.pushState=function(o,e,n){t.apply(this,[o,e,n]),window.requestAnimationFrame(()=>{w()})},window.addEventListener("popstate",()=>{window.requestAnimationFrame(()=>{w()})})}document.visibilityState!=="visible"?document.addEventListener("visibilitychange",()=>{!l&&document.visibilityState==="visible"&&w()}):w(),document.addEventListener("click",L)})();})();
